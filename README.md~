# SYMFONY 2 REST API LAB
========================

## NOTE:
- Trước khi bắt tay vào dự án cần cài đặt composer, Apache, PHP, MySQL

## I) APACHE ENVIRONMENT SETUP

### 1.1) Virtual Host:
```
<VirtualHost *:80>
	#SSLEngine on
	#SSLCertificateFile "conf/ssl.crt/server.crt"
	#SSLCertificateKeyFile "conf/ssl.key/server.key"
	#DirectoryIndex  app.php

	ServerAdmin tuanquynh0508@gmail.com
	ServerName api-news.local
	ServerAlias *.api-news.local
	
	DocumentRoot "/home/tnguyennhu/Public/Symfony2/api-news/web"
	SetEnv sfEnv dev
        <Directory "/home/tnguyennhu/Public/Symfony2/api-news/web">
                Options Indexes FollowSymLinks
                AllowOverride all
		Require all granted
                <IfModule mod_rewrite.c>
                        RewriteEngine On
                        RewriteCond %{REQUEST_FILENAME} !-f
                        RewriteRule ^(.*)$ app_dev.php [QSA,L]
                        RewriteCond %{HTTP:Authorization} ^(.*)
                        RewriteRule .* - [e=HTTP_AUTHORIZATION:%1]
                </IfModule>
        </Directory>
	
	#For Ubuntu apache config
	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined
	
	#For Xampp windows config
	#ErrorLog "logs/api-news-error.log"
	#CustomLog "logs/api-news-access.log" combined
</VirtualHost>
```

### 1.2) Add HOST File
```
127.0.0.1 api-news.local
```

## II) SYMFONY SETUP CODE
-------------------------

### 2.1) Get Composer
- Vào thư mục gốc của code (api-news folder) để cập nhật các thư viện của Symfony về, gõ:
```
composer update
```

### 2.2) Config Database
- Vào file app/config/parameters.yml, sửa đổi thông tin database cho đúng

### 2.3) Tạo database
- Từ thư mục gốc của code (api-news folder), gõ lệnh sau để tạo database:
```
php app/console doctrine:database:create
php app/console doctrine:schema:create
```
- Hoặc là sử dụng luôn file SQL database.sql để restore database

### 2.4) Insert Data Fixturer mẫu
- Từ thư mục gốc của code (api-news folder), gõ lệnh sau để tạo database:
```
php app/console doctrine:fixtures:load
```


## III) Xem API Doc
-------------------
- Từ trình duyệt gõ http://api-news.local/api/doc để xem thông tin về các Api. Có thể get api result bằng sandbox trong api doc cũng được.


## IV) Chạy API
----------------
- Sử dụng Postman trên Chrome để chạy thử api, đường link truy cập vào api như sau:
* http://api-news.local/api/v1/article.json?id=xxx
* http://api-news.local/api/v1/articles.json?page=1&limit=10&category_id=xxxx
* http://api-news.local/api/v1/categories.json

## V) BONUS
-----------
- Lệnh show danh sách tra API trong console:
```
php app/console route:debug | grep api
```

